{"ast":null,"code":"// src/pages/ConveniosPage.jsx\nimport React,{useState,useEffect,useCallback}from'react';import{Box,Typography,Paper,Button,CircularProgress,Accordion,AccordionSummary,AccordionDetails,List,ListItem,ListItemText,IconButton}from'@mui/material';import ExpandMoreIcon from'@mui/icons-material/ExpandMore';import EditIcon from'@mui/icons-material/Edit';import DeleteIcon from'@mui/icons-material/Delete';import apiClient from'../api/axiosConfig';import{useSnackbar}from'../contexts/SnackbarContext';// --- 1. IMPORTE O NOVO MODAL ---\nimport ConvenioModal from'../components/configuracoes/ConvenioModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ConveniosPage(){const[convenios,setConvenios]=useState([]);const[isLoading,setIsLoading]=useState(true);const{showSnackbar}=useSnackbar();// --- 2. ATIVE OS ESTADOS DO MODAL ---\nconst[isModalOpen,setIsModalOpen]=useState(false);const[convenioParaEditar,setConvenioParaEditar]=useState(null);const fetchConvenios=useCallback(async()=>{try{const response=await apiClient.get('/faturamento/convenios/');setConvenios(response.data);}catch(error){showSnackbar('Erro ao carregar convênios.','error');}finally{setIsLoading(false);}},[showSnackbar]);useEffect(()=>{fetchConvenios();},[fetchConvenios]);// --- 3. ATIVE A FUNÇÃO PARA ABRIR O MODAL ---\nconst handleOpenModal=function(){let convenio=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;setConvenioParaEditar(convenio);setIsModalOpen(true);};const handleDelete=async id=>{if(window.confirm('Tem certeza? Deletar um convênio também deletará todos os seus planos associados.')){try{await apiClient.delete(\"/faturamento/convenios/\".concat(id,\"/\"));showSnackbar('Convênio deletado com sucesso!','success');fetchConvenios();}catch(error){showSnackbar('Erro ao deletar convênio.','error');}}};if(isLoading)return/*#__PURE__*/_jsx(CircularProgress,{});return/*#__PURE__*/_jsxs(Paper,{sx:{p:2,margin:'auto'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:\"Gest\\xE3o de Conv\\xEAnios e Planos\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:()=>handleOpenModal(),children:\"Novo Conv\\xEAnio\"})]}),convenios.map(convenio=>/*#__PURE__*/_jsxs(Accordion,{children:[/*#__PURE__*/_jsxs(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMoreIcon,{}),children:[/*#__PURE__*/_jsx(Typography,{sx:{flexGrow:1,fontWeight:'bold'},children:convenio.nome}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",sx:{mr:1},onClick:e=>{e.stopPropagation();handleOpenModal(convenio);},children:/*#__PURE__*/_jsx(EditIcon,{})}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:e=>{e.stopPropagation();handleDelete(convenio.id);},children:/*#__PURE__*/_jsx(DeleteIcon,{color:\"error\"})})]}),/*#__PURE__*/_jsxs(AccordionDetails,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",children:\"Planos Cadastrados:\"}),/*#__PURE__*/_jsx(List,{dense:true,children:convenio.planos&&convenio.planos.length>0?convenio.planos.map(plano=>/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:plano.nome,secondary:plano.descricao})},plano.id)):/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:\"Nenhum plano cadastrado para este conv\\xEAnio.\"})})})]})]},convenio.id)),/*#__PURE__*/_jsx(ConvenioModal,{open:isModalOpen,onClose:()=>setIsModalOpen(false),onSave:fetchConvenios,convenioParaEditar:convenioParaEditar})]});}","map":{"version":3,"names":["React","useState","useEffect","useCallback","Box","Typography","Paper","Button","CircularProgress","Accordion","AccordionSummary","AccordionDetails","List","ListItem","ListItemText","IconButton","ExpandMoreIcon","EditIcon","DeleteIcon","apiClient","useSnackbar","ConvenioModal","jsx","_jsx","jsxs","_jsxs","ConveniosPage","convenios","setConvenios","isLoading","setIsLoading","showSnackbar","isModalOpen","setIsModalOpen","convenioParaEditar","setConvenioParaEditar","fetchConvenios","response","get","data","error","handleOpenModal","convenio","arguments","length","undefined","handleDelete","id","window","confirm","delete","concat","sx","p","margin","children","display","justifyContent","alignItems","mb","variant","onClick","map","expandIcon","flexGrow","fontWeight","nome","size","mr","e","stopPropagation","color","dense","planos","plano","primary","secondary","descricao","open","onClose","onSave"],"sources":["/Users/macmini/Documents/Sistema_Consultorio/frontend/src/pages/ConveniosPage.jsx"],"sourcesContent":["// src/pages/ConveniosPage.jsx\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Box, Typography, Paper, Button, CircularProgress, Accordion, AccordionSummary, AccordionDetails, List, ListItem, ListItemText, IconButton } from '@mui/material';\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore';\nimport EditIcon from '@mui/icons-material/Edit';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport apiClient from '../api/axiosConfig';\nimport { useSnackbar } from '../contexts/SnackbarContext';\n// --- 1. IMPORTE O NOVO MODAL ---\nimport ConvenioModal from '../components/configuracoes/ConvenioModal';\n\nexport default function ConveniosPage() {\n    const [convenios, setConvenios] = useState([]);\n    const [isLoading, setIsLoading] = useState(true);\n    const { showSnackbar } = useSnackbar();\n\n    // --- 2. ATIVE OS ESTADOS DO MODAL ---\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [convenioParaEditar, setConvenioParaEditar] = useState(null);\n\n    const fetchConvenios = useCallback(async () => {\n        try {\n            const response = await apiClient.get('/faturamento/convenios/');\n            setConvenios(response.data);\n        } catch (error) {\n            showSnackbar('Erro ao carregar convênios.', 'error');\n        } finally {\n            setIsLoading(false);\n        }\n    }, [showSnackbar]);\n\n    useEffect(() => {\n        fetchConvenios();\n    }, [fetchConvenios]);\n    \n    // --- 3. ATIVE A FUNÇÃO PARA ABRIR O MODAL ---\n    const handleOpenModal = (convenio = null) => {\n        setConvenioParaEditar(convenio);\n        setIsModalOpen(true);\n    };\n\n    const handleDelete = async (id) => {\n        if (window.confirm('Tem certeza? Deletar um convênio também deletará todos os seus planos associados.')) {\n            try {\n                await apiClient.delete(`/faturamento/convenios/${id}/`);\n                showSnackbar('Convênio deletado com sucesso!', 'success');\n                fetchConvenios();\n            } catch (error) {\n                showSnackbar('Erro ao deletar convênio.', 'error');\n            }\n        }\n    };\n\n    if (isLoading) return <CircularProgress />;\n\n    return (\n        <Paper sx={{ p: 2, margin: 'auto' }}>\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n                <Typography variant=\"h5\">Gestão de Convênios e Planos</Typography>\n                {/* 4. ATIVE O BOTÃO \"NOVO CONVÊNIO\" */}\n                <Button variant=\"contained\" onClick={() => handleOpenModal()}>Novo Convênio</Button>\n            </Box>\n            \n            {convenios.map(convenio => (\n                <Accordion key={convenio.id}>\n                    <AccordionSummary expandIcon={<ExpandMoreIcon />}>\n                        <Typography sx={{ flexGrow: 1, fontWeight: 'bold' }}>{convenio.nome}</Typography>\n                        {/* 5. ATIVE O BOTÃO DE EDIÇÃO */}\n                        <IconButton size=\"small\" sx={{ mr: 1 }} onClick={(e) => { e.stopPropagation(); handleOpenModal(convenio); }}><EditIcon /></IconButton>\n                        <IconButton size=\"small\" onClick={(e) => { e.stopPropagation(); handleDelete(convenio.id); }}><DeleteIcon color=\"error\" /></IconButton>\n                    </AccordionSummary>\n                    <AccordionDetails>\n                        <Typography variant=\"subtitle2\">Planos Cadastrados:</Typography>\n                        <List dense>\n                            {convenio.planos && convenio.planos.length > 0 ? (\n                                convenio.planos.map(plano => (\n                                    <ListItem key={plano.id}>\n                                        <ListItemText primary={plano.nome} secondary={plano.descricao} />\n                                    </ListItem>\n                                ))\n                            ) : (\n                                <ListItem><ListItemText primary=\"Nenhum plano cadastrado para este convênio.\" /></ListItem>\n                            )}\n                        </List>\n                    </AccordionDetails>\n                </Accordion>\n            ))}\n            \n            {/* 6. ATIVE O MODAL */}\n            <ConvenioModal open={isModalOpen} onClose={() => setIsModalOpen(false)} onSave={fetchConvenios} convenioParaEditar={convenioParaEditar} />\n        </Paper>\n    );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}