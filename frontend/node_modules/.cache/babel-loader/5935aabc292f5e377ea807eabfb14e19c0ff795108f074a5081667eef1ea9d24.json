{"ast":null,"code":"// src/pages/ConfiguracoesPage.jsx - VERSÃO REVISADA\nimport React,{useState,useEffect,useCallback}from'react';import{Box,Typography,Paper,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,CircularProgress,Switch,Button,IconButton}from'@mui/material';import apiClient from'../api/axiosConfig';import{useSnackbar}from'../contexts/SnackbarContext';import UsuarioModal from'../components/configuracoes/UsuarioModal';import{Link as RouterLink}from'react-router-dom';import EditIcon from'@mui/icons-material/Edit';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ConfiguracoesPage(){const[users,setUsers]=useState([]);const[isLoading,setIsLoading]=useState(true);const{showSnackbar}=useSnackbar();const[isModalOpen,setIsModalOpen]=useState(false);const[editingUser,setEditingUser]=useState(null);const fetchUsers=useCallback(async()=>{setIsLoading(true);try{const response=await apiClient.get('/usuarios/usuarios/');setUsers(response.data);}catch(error){showSnackbar('Erro ao carregar usuários.','error');}finally{setIsLoading(false);}},[showSnackbar]);useEffect(()=>{fetchUsers();},[fetchUsers]);const handleOpenModal=function(){let user=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;setEditingUser(user);setIsModalOpen(true);};const handleCloseModal=()=>{setIsModalOpen(false);setEditingUser(null);};const handleToggleActive=async user=>{const newStatus=!user.is_active;try{await apiClient.patch(\"/usuarios/usuarios/\".concat(user.id,\"/\"),{is_active:newStatus});showSnackbar(\"Usu\\xE1rio \".concat(user.first_name,\" \").concat(newStatus?'ativado':'desativado',\".\"),'success');fetchUsers();}catch(error){showSnackbar('Erro ao atualizar status do usuário.','error');}};if(isLoading)return/*#__PURE__*/_jsx(CircularProgress,{});return/*#__PURE__*/_jsxs(Paper,{sx:{p:2,margin:'auto'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:\"Configura\\xE7\\xF5es Gerais\"}),\" \",/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",component:RouterLink,to:\"/configuracoes/categorias-despesa\",children:\"Categorias de Despesa\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",component:RouterLink,to:\"/configuracoes/convenios\",children:\"Conv\\xEAnios\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",component:RouterLink,to:\"/configuracoes/especialidades\",children:\"Especialidades\"}),/*#__PURE__*/_jsxs(Button,{variant:\"contained\",onClick:()=>handleOpenModal(),children:[\" \",\"Criar Novo Usu\\xE1rio\"]})]})]}),/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"Nome Completo\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Usu\\xE1rio (Login)\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Cargo\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Status (Ativo)\"}),/*#__PURE__*/_jsx(TableCell,{align:\"right\",children:\"A\\xE7\\xF5es\"}),\" \"]})}),/*#__PURE__*/_jsx(TableBody,{children:users.map(user=>/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsxs(TableCell,{children:[user.first_name,\" \",user.last_name]}),/*#__PURE__*/_jsx(TableCell,{children:user.username}),/*#__PURE__*/_jsx(TableCell,{sx:{textTransform:'capitalize'},children:user.cargo}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:/*#__PURE__*/_jsx(Switch,{checked:user.is_active,onChange:()=>handleToggleActive(user),color:\"success\",title:user.is_active?\"Desativar usuário\":\"Ativar usuário\"})}),/*#__PURE__*/_jsxs(TableCell,{align:\"right\",children:[\" \",/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleOpenModal(user),children:/*#__PURE__*/_jsx(EditIcon,{})})]})]},user.id))})]})}),/*#__PURE__*/_jsx(UsuarioModal,{open:isModalOpen,onClose:handleCloseModal,onSave:fetchUsers,usuarioParaEditar:editingUser// <-- NOVA PROP\n})]});}","map":{"version":3,"names":["React","useState","useEffect","useCallback","Box","Typography","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","CircularProgress","Switch","Button","IconButton","apiClient","useSnackbar","UsuarioModal","Link","RouterLink","EditIcon","jsx","_jsx","jsxs","_jsxs","ConfiguracoesPage","users","setUsers","isLoading","setIsLoading","showSnackbar","isModalOpen","setIsModalOpen","editingUser","setEditingUser","fetchUsers","response","get","data","error","handleOpenModal","user","arguments","length","undefined","handleCloseModal","handleToggleActive","newStatus","is_active","patch","concat","id","first_name","sx","p","margin","children","display","justifyContent","alignItems","mb","variant","gap","component","to","onClick","align","map","hover","last_name","username","textTransform","cargo","checked","onChange","color","title","open","onClose","onSave","usuarioParaEditar"],"sources":["/Users/macmini/Documents/Sistema_Consultorio/frontend/src/pages/ConfiguracoesPage.jsx"],"sourcesContent":["// src/pages/ConfiguracoesPage.jsx - VERSÃO REVISADA\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { \n    Box, Typography, Paper, Table, TableBody, TableCell, \n    TableContainer, TableHead, TableRow, CircularProgress, Switch, Button, IconButton \n} from '@mui/material';\nimport apiClient from '../api/axiosConfig';\nimport { useSnackbar } from '../contexts/SnackbarContext';\nimport UsuarioModal from '../components/configuracoes/UsuarioModal';\nimport { Link as RouterLink } from 'react-router-dom';\nimport EditIcon from '@mui/icons-material/Edit';\n\nexport default function ConfiguracoesPage() {\n    const [users, setUsers] = useState([]);\n    const [isLoading, setIsLoading] = useState(true);\n    const { showSnackbar } = useSnackbar();\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [editingUser, setEditingUser] = useState(null);\n    \n    const fetchUsers = useCallback(async () => {\n        setIsLoading(true);\n        try {\n            const response = await apiClient.get('/usuarios/usuarios/');\n            setUsers(response.data);\n        } catch (error) {\n            showSnackbar('Erro ao carregar usuários.', 'error');\n        } finally {\n            setIsLoading(false);\n        }\n    }, [showSnackbar]);\n\n    useEffect(() => {\n        fetchUsers();\n    }, [fetchUsers]);\n\n    const handleOpenModal = (user = null) => {\n        setEditingUser(user);\n        setIsModalOpen(true);\n    };\n\n    const handleCloseModal = () => {\n        setIsModalOpen(false);\n        setEditingUser(null);\n    };\n\n    const handleToggleActive = async (user) => {\n        const newStatus = !user.is_active;\n        try {\n            await apiClient.patch(`/usuarios/usuarios/${user.id}/`, { is_active: newStatus });\n            showSnackbar(`Usuário ${user.first_name} ${newStatus ? 'ativado' : 'desativado'}.`, 'success');\n            fetchUsers();\n        } catch (error) {\n            showSnackbar('Erro ao atualizar status do usuário.', 'error');\n        }\n    };\n\n    if (isLoading) return <CircularProgress />;\n\n    return (\n        <Paper sx={{ p: 2, margin: 'auto' }}>\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n                <Typography variant=\"h5\">Configurações Gerais</Typography> {/* Título ajustado para ser mais genérico */}\n                <Box sx={{ display: 'flex', gap: 2 }}>\n                    <Button variant=\"outlined\" component={RouterLink} to=\"/configuracoes/categorias-despesa\">\n                        Categorias de Despesa\n                    </Button>\n                    <Button variant=\"outlined\" component={RouterLink} to=\"/configuracoes/convenios\">\n                        Convênios\n                    </Button>\n                    {/* --- BOTÃO NOVO ADICIONADO AQUI --- */}\n                    <Button variant=\"outlined\" component={RouterLink} to=\"/configuracoes/especialidades\">\n                        Especialidades\n                    </Button>\n                    <Button variant=\"contained\" onClick={() => handleOpenModal()}> {/* Modificado */}\n                        Criar Novo Usuário\n                    </Button>\n                </Box>\n            </Box>\n            {/* --- CORREÇÃO: A TABELA QUE ESTAVA FALTANDO FOI ADICIONADA AQUI --- */}\n            <TableContainer>\n                <Table>\n                    <TableHead>\n                        <TableRow>\n                            <TableCell>Nome Completo</TableCell>\n                            <TableCell>Usuário (Login)</TableCell>\n                            <TableCell>Cargo</TableCell>\n                            <TableCell align=\"center\">Status (Ativo)</TableCell>\n                            <TableCell align=\"right\">Ações</TableCell> {/* <-- NOVA COLUNA */}\n                        </TableRow>\n                    </TableHead>\n                    <TableBody>\n                        {users.map((user) => (\n                            <TableRow key={user.id} hover>\n                                <TableCell>{user.first_name} {user.last_name}</TableCell>\n                                <TableCell>{user.username}</TableCell>\n                                <TableCell sx={{ textTransform: 'capitalize' }}>{user.cargo}</TableCell>\n                                <TableCell align=\"center\">\n                                    <Switch\n                                        checked={user.is_active}\n                                        onChange={() => handleToggleActive(user)}\n                                        color=\"success\"\n                                        title={user.is_active ? \"Desativar usuário\" : \"Ativar usuário\"}\n                                    />\n                                 </TableCell>\n                                <TableCell align=\"right\"> {/* <-- CÉLULA COM O BOTÃO */}\n                                    <IconButton onClick={() => handleOpenModal(user)}>\n                                        <EditIcon />\n                                    </IconButton>\n                                </TableCell>\n                            </TableRow>\n                        ))}\n                    </TableBody>\n                </Table>\n            </TableContainer>\n\n            <UsuarioModal \n                open={isModalOpen}\n                onClose={handleCloseModal}\n                onSave={fetchUsers}\n                usuarioParaEditar={editingUser} // <-- NOVA PROP\n            />\n        </Paper>\n    );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}