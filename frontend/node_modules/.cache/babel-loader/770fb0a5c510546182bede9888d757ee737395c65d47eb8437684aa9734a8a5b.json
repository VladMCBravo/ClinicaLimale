{"ast":null,"code":"// src/components/prontuario/ExamesDicomTab.jsx\nimport React,{useState,useEffect,useCallback}from'react';import apiClient from'../../api/axiosConfig';import{Box,Typography,CircularProgress,List,ListItem,ListItemText,Paper,Divider}from'@mui/material';import{useSnackbar}from'../../contexts/SnackbarContext';import DicomViewer from'../dicom/DicomViewer';// <-- 1. IMPORTE O DICOM VIEWER\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ExamesDicomTab(_ref){let{pacienteId}=_ref;const[exames,setExames]=useState([]);const[isLoading,setIsLoading]=useState(true);const[selectedExame,setSelectedExame]=useState(null);// <-- 2. ESTADO PARA O EXAME SELECIONADO\nconst{showSnackbar}=useSnackbar();const fetchExames=useCallback(async()=>{setIsLoading(true);try{// --- 3. AJUSTE A URL PARA A ROTA CORRETA ---\nconst response=await apiClient.get(\"/integracao/pacientes/\".concat(pacienteId,\"/exames/\"));setExames(response.data);}catch(error){console.error(\"Erro ao buscar exames DICOM:\",error);showSnackbar('Falha ao carregar exames de imagem.','error');}finally{setIsLoading(false);}},[pacienteId,showSnackbar]);useEffect(()=>{fetchExames();},[fetchExames]);const handleSelectExame=exame=>{setSelectedExame(exame);};const handleCloseViewer=()=>{setSelectedExame(null);};if(isLoading){return/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',p:3},children:/*#__PURE__*/_jsx(CircularProgress,{})});}// --- 4. LÓGICA DE RENDERIZAÇÃO CONDICIONAL ---\nif(selectedExame){// Se um exame estiver selecionado, mostre o viewer\nreturn/*#__PURE__*/_jsx(DicomViewer,{exame:selectedExame,onClose:handleCloseViewer});}// Se nenhum exame estiver selecionado, mostre a lista\nreturn/*#__PURE__*/_jsxs(Paper,{sx:{p:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{mb:2},children:\"Exames de Imagem\"}),exames.length===0?/*#__PURE__*/_jsx(Typography,{children:\"Nenhum exame de imagem encontrado para este paciente.\"}):/*#__PURE__*/_jsx(List,{children:exames.map((exame,index)=>/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(ListItem,{button:true,onClick:()=>handleSelectExame(exame),children:/*#__PURE__*/_jsx(ListItemText,{primary:exame.study_description||\"Exame sem descrição\",secondary:\"Data: \".concat(new Date(exame.study_date).toLocaleDateString('pt-BR'))})}),index<exames.length-1&&/*#__PURE__*/_jsx(Divider,{})]},exame.id))})]});}","map":{"version":3,"names":["React","useState","useEffect","useCallback","apiClient","Box","Typography","CircularProgress","List","ListItem","ListItemText","Paper","Divider","useSnackbar","DicomViewer","jsx","_jsx","jsxs","_jsxs","ExamesDicomTab","_ref","pacienteId","exames","setExames","isLoading","setIsLoading","selectedExame","setSelectedExame","showSnackbar","fetchExames","response","get","concat","data","error","console","handleSelectExame","exame","handleCloseViewer","sx","display","justifyContent","p","children","onClose","variant","mb","length","map","index","Fragment","button","onClick","primary","study_description","secondary","Date","study_date","toLocaleDateString","id"],"sources":["/Users/macmini/Documents/Sistema_Consultorio/frontend/src/components/prontuario/ExamesDicomTab.jsx"],"sourcesContent":["// src/components/prontuario/ExamesDicomTab.jsx\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport apiClient from '../../api/axiosConfig';\nimport { \n  Box, \n  Typography, \n  CircularProgress, \n  List, \n  ListItem, \n  ListItemText,\n  Paper,\n  Divider\n} from '@mui/material';\nimport { useSnackbar } from '../../contexts/SnackbarContext';\nimport DicomViewer from '../dicom/DicomViewer'; // <-- 1. IMPORTE O DICOM VIEWER\n\nexport default function ExamesDicomTab({ pacienteId }) {\n  const [exames, setExames] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [selectedExame, setSelectedExame] = useState(null); // <-- 2. ESTADO PARA O EXAME SELECIONADO\n  const { showSnackbar } = useSnackbar();\n\n  const fetchExames = useCallback(async () => {\n    setIsLoading(true);\n    try {\n      // --- 3. AJUSTE A URL PARA A ROTA CORRETA ---\n      const response = await apiClient.get(`/integracao/pacientes/${pacienteId}/exames/`);\n      setExames(response.data);\n    } catch (error) {\n      console.error(\"Erro ao buscar exames DICOM:\", error);\n      showSnackbar('Falha ao carregar exames de imagem.', 'error');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [pacienteId, showSnackbar]);\n\n  useEffect(() => {\n    fetchExames();\n  }, [fetchExames]);\n\n  const handleSelectExame = (exame) => {\n    setSelectedExame(exame);\n  };\n\n  const handleCloseViewer = () => {\n    setSelectedExame(null);\n  };\n\n  if (isLoading) {\n    return <Box sx={{ display: 'flex', justifyContent: 'center', p: 3 }}><CircularProgress /></Box>;\n  }\n  \n  // --- 4. LÓGICA DE RENDERIZAÇÃO CONDICIONAL ---\n  if (selectedExame) {\n    // Se um exame estiver selecionado, mostre o viewer\n    return <DicomViewer exame={selectedExame} onClose={handleCloseViewer} />;\n  }\n\n  // Se nenhum exame estiver selecionado, mostre a lista\n  return (\n    <Paper sx={{ p: 2 }}>\n      <Typography variant=\"h6\" sx={{ mb: 2 }}>Exames de Imagem</Typography>\n      {exames.length === 0 ? (\n        <Typography>Nenhum exame de imagem encontrado para este paciente.</Typography>\n      ) : (\n        <List>\n          {exames.map((exame, index) => (\n            <React.Fragment key={exame.id}>\n              <ListItem \n                button \n                onClick={() => handleSelectExame(exame)}\n              >\n                <ListItemText \n                  primary={exame.study_description || \"Exame sem descrição\"}\n                  secondary={`Data: ${new Date(exame.study_date).toLocaleDateString('pt-BR')}`} \n                />\n              </ListItem>\n              {index < exames.length - 1 && <Divider />}\n            </React.Fragment>\n          ))}\n        </List>\n      )}\n    </Paper>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}